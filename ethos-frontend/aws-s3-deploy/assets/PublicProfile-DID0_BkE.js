import{h as S,r as n,j as e,a as m}from"./index-CxzMjhE-.js";import{u as Q}from"./useSocket-B9IG26Ws.js";import{u as F}from"./useBoard-BWIqxM7N.js";import{u as k}from"./useQuest-BW7Znkqp.js";import{u as E}from"./usePost-cu-m9d1_.js";import{B as O}from"./Banner-C5qimYCt.js";import{B as b}from"./Board-DvHUsBFG.js";import{R}from"./ReviewForm-yoZxRLyo.js";import"./quest-3nETprwz.js";import"./post-BFgSlzkn.js";import"./useGraph-Br1XlEWj.js";import"./GridLayout-DEWRpfJd.js";import"./Button-BBg8DJkg.js";import"./displayUtils-C2lD-HWY.js";import"./AvatarStack-DgfcvvW3.js";import"./usePermissions-alxmqwVa.js";import"./review-ZbVpCwUE.js";const Y=()=>{var p,y;const{userId:r}=S(),[c,j]=n.useState(null),[i,u]=n.useState(null),[a,d]=n.useState(null),[h,P]=n.useState(""),{loadPublicBoards:N}=F(),{fetchPostsForBoard:I,enrichPosts:x}=E(),{fetchQuestsForBoard:w,enrichQuests:f}=k();return n.useEffect(()=>{if(!r)return;(async()=>{try{const{profile:t,quests:o,posts:l}=await N(r),g=o.enrichedItems||await f(o.items),v=l.enrichedItems||await x(l.items);j(t),u({...o,enrichedItems:g}),d({...l,enrichedItems:v})}catch(t){console.error("[PublicProfilePage] Failed to load:",t),P("User not found or profile is private.")}})()},[r]),Q("board:update",s=>{!r||s.userId!==r||(async()=>{try{if(s.id===(i==null?void 0:i.id)){const t=await w(s.id,r),o=await f(t);u({...s,enrichedItems:o})}if(s.id===(a==null?void 0:a.id)){const t=await I(s.id,r),o=await x(t);d({...s,enrichedItems:o})}}catch(t){console.error("[Socket board:update] Failed to fetch or enrich items:",t)}})()}),h?e.jsx("div",{className:"text-center text-red-600 py-8",children:h}):c?e.jsxs("main",{className:"max-w-6xl mx-auto px-4 py-10 bg-soft dark:bg-soft-dark text-primary",children:[e.jsx(O,{user:c,readOnly:!0}),e.jsxs("section",{className:"mt-12",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4 text-primary",children:"üìò Public Quests"}),i?(p=i.enrichedItems)!=null&&p.length?e.jsx(b,{board:i,layout:"graph",user:c,readOnly:!0}):e.jsx("div",{className:"text-secondary text-center py-8",children:"No public quests available."}):e.jsx(m,{})]}),e.jsxs("section",{className:"mt-12",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4 text-primary",children:"üß≠ Public Posts"}),a?(y=a.enrichedItems)!=null&&y.length?e.jsx(b,{board:a,layout:"grid",compact:!0,hideControls:!0,headerOnly:!0,user:c,readOnly:!0}):e.jsx("div",{className:"text-secondary text-center py-8",children:"No public posts found."}):e.jsx(m,{})]}),e.jsxs("section",{className:"mt-12",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4 text-primary",children:"‚≠ê Leave a Review"}),e.jsx(R,{targetType:"creator",modelId:c.id})]})]}):e.jsx(m,{})};export{Y as default};
