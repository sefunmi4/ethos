import{r as l,j as e,S as u,u as v,a as g}from"./index-CxzMjhE-.js";import{m as f,b as m}from"./quest-3nETprwz.js";import{B as b}from"./Button-BBg8DJkg.js";import{t as x}from"./displayUtils-C2lD-HWY.js";import"./post-BFgSlzkn.js";const h=[{value:"public",label:"Public"},{value:"private",label:"Private"},{value:"hidden",label:"Hidden"}],j=[{value:"approved",label:"Approved"},{value:"flagged",label:"Flagged"},{value:"banned",label:"Banned"}],S=({quest:a,onUpdated:s})=>{const[n,d]=l.useState(a.visibility),[i,o]=l.useState(a.approvalStatus),[c,r]=l.useState(!1),p=async()=>{r(!0);try{const t=await f(a.id,{visibility:n,approvalStatus:i});s==null||s(t)}catch(t){console.error("[ModReviewPanel] failed to update quest",t)}finally{r(!1)}};return e.jsxs("div",{className:"space-y-2 border p-3 rounded bg-surface dark:bg-background",children:[e.jsx("div",{className:"font-semibold",children:x(a.title)}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(u,{value:n,onChange:t=>d(t.target.value),options:h}),e.jsx(u,{value:i,onChange:t=>o(t.target.value),options:j}),e.jsx(b,{onClick:p,disabled:c,children:"Save"})]})]})},A=()=>{const{user:a}=v(),[s,n]=l.useState([]),[d,i]=l.useState(!0);return l.useEffect(()=>{(async()=>{i(!0);try{const c=await m();n(c.filter(r=>r.approvalStatus==="flagged"))}finally{i(!1)}})()},[]),(a==null?void 0:a.role)!=="moderator"&&(a==null?void 0:a.role)!=="admin"?e.jsx("div",{children:"Forbidden"}):d?e.jsx(g,{}):e.jsxs("main",{className:"container mx-auto p-4 space-y-4",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Flagged Quests"}),s.map(o=>e.jsx(S,{quest:o,onUpdated:()=>{}},o.id)),s.length===0&&e.jsx("p",{children:"No flagged quests."})]})};export{A as default};
