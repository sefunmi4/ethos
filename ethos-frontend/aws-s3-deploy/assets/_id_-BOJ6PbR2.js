import{u as b,r as a,j as e,a as y,L as w,R as N,h as S}from"./index-CxzMjhE-.js";import{f as R}from"./review-ZbVpCwUE.js";import{c as E}from"./quest-3nETprwz.js";import{t as F}from"./displayUtils-C2lD-HWY.js";import"./post-BFgSlzkn.js";const h=240,p=16,M=()=>{const{user:r}=b(),[n,l]=a.useState([]),[c,f]=a.useState(!0),[o,d]=a.useState(0),u=a.useRef(null);a.useEffect(()=>{(async()=>{try{const s=await E(r==null?void 0:r.id);l(s||[])}catch(s){console.error("[FeaturedQuestBoard] Failed to load quests",s)}finally{f(!1)}})()},[r==null?void 0:r.id]);const m=5,i=a.useMemo(()=>{const t=n.length,s=Math.min(m,t),x=Math.max(0,Math.min(o-Math.floor(s/2),t-s));return Array.from({length:s},(T,g)=>x+g)},[o,n]),j=t=>{const s=u.current;if(!s)return;const x=(h+p)*t-s.clientWidth/2+h/2;s.scrollTo({left:x,behavior:"smooth"})};a.useEffect(()=>{c||j(o)},[o,c]);const v=()=>{const t=u.current;if(!t)return;const s=Math.round(t.scrollLeft/(h+p));s!==o&&d(s)};return c?e.jsx(y,{}):e.jsxs("div",{children:[e.jsxs("div",{className:"relative overflow-hidden",children:[e.jsx("div",{ref:u,onScroll:v,className:"flex gap-4 overflow-x-auto scroll-smooth snap-x snap-mandatory px-4",children:n.map((t,s)=>e.jsx("div",{className:"snap-center flex-shrink-0 w-60 transition-all duration-300 "+(s===o?"opacity-100 scale-100":Math.abs(s-o)===1?"opacity-80 scale-95":"opacity-50 scale-90"),children:e.jsxs("div",{className:"p-4 border rounded bg-surface dark:bg-background w-full",children:[e.jsx(w,{to:N.QUEST(t.id),className:"font-semibold text-blue-600 underline",children:F(t.title)}),typeof t.popularity=="number"&&e.jsxs("div",{className:"text-sm text-secondary mt-1",children:["Score: ",t.popularity]})]})},t.id))}),e.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 w-8 bg-gradient-to-r from-soft to-transparent"}),e.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 w-8 bg-gradient-to-l from-soft to-transparent"})]}),e.jsx("div",{className:"flex justify-center mt-3 gap-2",children:i.map(t=>e.jsx("button",{className:"h-2 w-2 rounded-full transition-all "+(t===o?"bg-accent opacity-100":"bg-secondary/40 opacity-70"),onClick:()=>d(t)},t))})]})},P=()=>{const{entityType:r,id:n}=S(),[l,c]=a.useState(null),[f,o]=a.useState(!0),[d,u]=a.useState("");return a.useEffect(()=>{if(!r||!n)return;(async()=>{try{const i=await R(r,n);c(i)}catch(i){console.error("[ReviewSummaryPage] Failed to load summary:",i),u("Failed to load review summary.")}finally{o(!1)}})()},[r,n]),f?e.jsx(y,{}):d?e.jsx("div",{className:"p-4 text-red-500",children:d}):e.jsxs("main",{className:"max-w-3xl mx-auto p-4 space-y-8",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Review Summary"}),l&&l.count>0?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:["Average Rating: ",l.averageRating," (",l.count," reviews)"]}),e.jsx("ul",{className:"list-disc list-inside text-sm",children:Object.entries(l.tagCounts).map(([m,i])=>e.jsxs("li",{children:[m,": ",i]},m))})]}):e.jsx("p",{children:"No reviews yet."}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Featured Quests"}),e.jsx(M,{})]})]})};export{P as default};
