import{r as i,j as e,F as H,o as P,p as q,S as y,I as D}from"./index-CxzMjhE-.js";import{u as U,a as W}from"./review-ZbVpCwUE.js";import{B as X}from"./Button-BBg8DJkg.js";import{F as l,V as Y,R as z,L as T,T as G}from"./GridLayout-DEWRpfJd.js";const Z=({reviewId:x,targetType:I,questId:k,postId:C,repoUrl:N,modelId:B,onSubmitted:c,initialRating:E=0,initialTags:V=[],initialFeedback:O="",initialVisibility:A="public",initialStatus:L="submitted"})=>{const[n,g]=i.useState(E),[p,h]=i.useState(V.join(", ")),[f,j]=i.useState(O),[v,S]=i.useState(A),[b,w]=i.useState(L),[u,F]=i.useState(!1),[R,d]=i.useState(""),_=async t=>{var r,o;if(t.preventDefault(),!u){if(!n){d("Rating is required");return}F(!0),d("");try{const s={targetType:I,rating:n,tags:p.split(",").map(m=>m.trim()).filter(Boolean),feedback:f,questId:k,postId:C,repoUrl:N,modelId:B,visibility:v,status:b},a=x?await U(x,s):await W(s);g(0),h(""),j(""),S("public"),w("submitted"),c==null||c(a)}catch(s){console.error("[ReviewForm] Failed to submit review:",s);const a=((o=(r=s==null?void 0:s.response)==null?void 0:r.data)==null?void 0:o.error)||"Failed to submit review.";d(a),alert(a)}finally{F(!1)}}};return e.jsxs("form",{onSubmit:_,className:"space-y-6",children:[e.jsx(l,{title:"Rating",children:e.jsx("div",{className:"flex space-x-1",children:[1,2,3,4,5].map(t=>{const r=n>=t,o=!r&&n>=t-.5;return e.jsx("button",{type:"button",onClick:s=>{const a=s.currentTarget.getBoundingClientRect(),m=s.clientX-a.left<a.width/2;g(m?t-.5:t)},className:"text-2xl focus:outline-none text-yellow-400",children:r?e.jsx(H,{}):o?e.jsx(P,{}):e.jsx(q,{})},t)})})}),e.jsx(l,{title:"Visibility",children:e.jsx(y,{value:v,onChange:t=>S(t.target.value),options:Y.slice()})}),e.jsx(l,{title:"Status",children:e.jsx(y,{value:b,onChange:t=>w(t.target.value),options:z.slice()})}),e.jsxs(l,{title:"Tags",children:[e.jsx(T,{htmlFor:"review-tags",children:"Comma-separated Tags"}),e.jsx(D,{id:"review-tags",value:p,onChange:t=>h(t.target.value),placeholder:"e.g. helpful, inspiring"})]}),e.jsxs(l,{title:"Feedback",children:[e.jsx(T,{htmlFor:"review-feedback",children:"Feedback"}),e.jsx(G,{id:"review-feedback",value:f,onChange:t=>j(t.target.value),placeholder:"Share your thoughts"})]}),R&&e.jsx("p",{className:"text-sm text-red-600",children:R}),e.jsx("div",{className:"flex justify-end",children:e.jsx(X,{type:"submit",variant:"contrast",disabled:u,children:u?"Submitting...":"Submit Review"})})]})};export{Z as R};
